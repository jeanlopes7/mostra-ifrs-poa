/*
    jQuery Masked Input Plugin
    Copyright (c) 2007 - 2014 Josh Bush (digitalbush.com)
    Licensed under the MIT license (http://digitalbush.com/projects/masked-input-plugin/#license)
    Version: 1.3.1
*/
!function(a){function b(){var a=document.createElement("input"),b="onpaste";return a.setAttribute(b,""),"function"==typeof a[b]?"paste":"input"}var c,d=b()+".mask",e=navigator.userAgent,f=/iphone/i.test(e),g=/chrome/i.test(e),h=/android/i.test(e);a.mask={definitions:{9:"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"},autoclear:!0,dataName:"rawMaskFn",placeholder:"_"},a.fn.extend({caret:function(a,b){var c;if(0!==this.length&&!this.is(":hidden"))return"number"==typeof a?(b="number"==typeof b?b:a,this.each(function(){this.setSelectionRange?this.setSelectionRange(a,b):this.createTextRange&&(c=this.createTextRange(),c.collapse(!0),c.moveEnd("character",b),c.moveStart("character",a),c.select())})):(this[0].setSelectionRange?(a=this[0].selectionStart,b=this[0].selectionEnd):document.selection&&document.selection.createRange&&(c=document.selection.createRange(),a=0-c.duplicate().moveStart("character",-1e5),b=a+c.text.length),{begin:a,end:b})},unmask:function(){return this.trigger("unmask")},mask:function(b,e){var i,j,k,l,m,n,o;return!b&&this.length>0?(i=a(this[0]),i.data(a.mask.dataName)()):(e=a.extend({autoclear:a.mask.autoclear,placeholder:a.mask.placeholder,completed:null},e),j=a.mask.definitions,k=[],l=n=b.length,m=null,a.each(b.split(""),function(a,b){"?"==b?(n--,l=a):j[b]?(k.push(new RegExp(j[b])),null===m&&(m=k.length-1)):k.push(null)}),this.trigger("unmask").each(function(){function i(a){for(;++a<n&&!k[a];);return a}function p(a){for(;--a>=0&&!k[a];);return a}function q(a,b){var c,d;if(!(0>a)){for(c=a,d=i(b);n>c;c++)if(k[c]){if(!(n>d&&k[c].test(A[d])))break;A[c]=A[d],A[d]=e.placeholder,d=i(d)}x(),z.caret(Math.max(m,a))}}function r(a){var b,c,d,f;for(b=a,c=e.placeholder;n>b;b++)if(k[b]){if(d=i(b),f=A[b],A[b]=c,!(n>d&&k[d].test(f)))break;c=f}}function s(){var a=z.val(),b=z.caret();if(a.length<o.length){for(y(!0);b.begin>0&&!k[b.begin-1];)b.begin--;if(0===b.begin)for(;b.begin<m&&!k[b.begin];)b.begin++;z.caret(b.begin,b.begin)}else{for(y(!0);b.begin<n&&!k[b.begin];)b.begin++;z.caret(b.begin,b.begin)}e.completed&&b==z.val().length&&e.completed.call(z)}function t(){y(),z.val()!=C&&z.change()}function u(a){var b,c,d,e=a.which;o=z.val(),8===e||46===e||f&&127===e?(b=z.caret(),c=b.begin,d=b.end,d-c===0&&(c=46!==e?p(c):d=i(c-1),d=46===e?i(d):d),w(c,d),q(c,d-1),a.preventDefault()):13===e?t.call(this,a):27===e&&(z.val(C),z.caret(0,y()),a.preventDefault())}function v(b){var c,d,f,g=b.which,j=z.caret();if(!(b.ctrlKey||b.altKey||b.metaKey||32>g)&&g&&13!==g){if(j.end-j.begin!==0&&(w(j.begin,j.end),q(j.begin,j.end-1)),c=i(j.begin-1),n>c&&(d=String.fromCharCode(g),k[c].test(d))){if(r(c),A[c]=d,x(),f=i(c),h){var l=function(){a.proxy(a.fn.caret,z,f)()};setTimeout(l,0)}else z.caret(f);e.completed&&f>=n&&e.completed.call(z)}b.preventDefault()}}function w(a,b){var c;for(c=a;b>c&&n>c;c++)k[c]&&(A[c]=e.placeholder)}function x(){z.val(A.join(""))}function y(a){var b,c,d,f=z.val(),g=-1;for(b=0,d=0;n>b;b++)if(k[b]){for(A[b]=e.placeholder;d++<f.length;)if(c=f.charAt(d-1),k[b].test(c)){A[b]=c,g=b;break}if(d>f.length)break}else A[b]===f.charAt(d)&&b!==l&&(d++,g=b);return a?x():l>g+1?e.autoclear||A.join("")===B?(z.val()&&z.val(""),w(0,n)):x():(x(),z.val(z.val().substring(0,g+1))),l?b:m}var z=a(this),A=a.map(b.split(""),function(a){return"?"!=a?j[a]?e.placeholder:a:void 0}),B=A.join(""),C=z.val();z.data(a.mask.dataName,function(){return a.map(A,function(a,b){return k[b]&&a!=e.placeholder?a:null}).join("")}),z.attr("readonly")||z.one("unmask",function(){z.off(".mask").removeData(a.mask.dataName)}).on("focus.mask",function(){clearTimeout(c);var a;C=z.val(),a=y(),c=setTimeout(function(){x(),a==b.replace("?","").length?z.caret(0,a):z.caret(a)},10)}).on("blur.mask",t).on("keydown.mask",u).on("keypress.mask",v).on(d,function(){setTimeout(function(){var a=y(!0);z.caret(a),e.completed&&a==z.val().length&&e.completed.call(z)},0)}),g&&h&&z.off("input.mask").on("input.mask",s),y()}))}})}(jQuery);
